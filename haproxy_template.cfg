defaults
  option  tcplog

{{range $i, $listener := .frontends -}}
frontend {{$listener.Name}}
  bind {{.ListenIp}}:{{$listener.Port}}
  mode tcp
  default_backend {{$listener.Backend}}
{{end -}}

{{range $i, $backend := .backends}}
backend {{$backend.Name}}
  mode tcp
{{- range $j, $ep := $backend.Endpoints}}
  server {{$ep.Name}} {{$ep.IP}}:{{$ep.Port -}}
{{end -}}
{{end}}
